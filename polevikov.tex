\documentclass[a4paper, 12pt]{article}
\usepackage{pgfplots}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath}
\usepackage{indentfirst}
\usepackage[top=2cm, bottom=2cm, left=3cm, right=1cm]{geometry}
\numberwithin{equation}{section}

\newcommand{\der}[2]{\frac{\partial {#1}}{\partial {#2}}}
\newcommand{\dder}[2]{\frac{\partial^2 {#1}}{\partial {#2}^2}}
\newcommand{\psp}[2]{\psi_{\mathring{#1}}^{#2}}

\begin{document}
  Уравнение гравитационной конвекции с несжимаемой жидкостю и отсутствием
  источников тепла внутри жидкости:

  $$
    \left\{
      \begin{aligned}
        &\der{T}{t} + \der{\psi}{y} \der{T}{x} - \der{\psi}{x} \der{T}{y} =
          a \left( \dder{T}{x} + \dder{T}{y} \right)
        \\
        &\dder{\psi}{x} + \dder{\psi}{y} + \omega = 0
        \\
        &\der{\omega}{t} + \der{\psi}{y} \der{\omega}{x} - \der{\psi}{x}
          \der{\omega}{y} = \nu \left(
            \dder{\omega}{x} + \dder{\omega}{y}
          \right) + \beta g \der{T}{x}
      \end{aligned}
    \right.
  $$

  Безразмерная форма:

  $$
    \left\{
      \begin{aligned}
        &\der{\psi}{y} \der{T}{x} - \der{\psi}{x} \der{T}{y} = \frac{1}{Pr}
          \left( \dder{T}{x} + \dder{T}{y} \right)
        \\
        &\dder{\psi}{x} + \dder{\psi}{y} + \omega = 0
        \\
        &\der{\psi}{y} \der{\omega}{x} - \der{\psi}{x} \der{\psi}{y} =
          \dder{\omega}{x} + \dder{\omega}{y} + Gr \der{T}{x}
      \end{aligned}
    \right.
  $$

  где $Pr = \frac{v}{a}, \quad Gr = \frac{\beta g \Delta T l^{3}}{\nu}$

  Построим монотонную разностную схему первого порядка. Для монотонности
  разностная схема должна удовлетворить принципу максимума

  Уравнение сохранения тепла:

  \begin{gather*}
    \der{\psi}{y} \der{T}{x} - \der{\psi}{x} \der{T}{y} = \frac{1}{Pr}
      \left( \dder{T}{x} + \dder{T}{y} \right)
    \\
    \der{\psi}{y} \der{T}{x} = \psp{y}{+} T_{\overline{x}} + \psp{y}{-} T_{x}
    \\
    \der{\psi}{x} \der{T}{y} = \psp{x}{+} T_{y} + \psp{x}{-} T_{\overline{y}}
  \end{gather*}
  \begin{multline*}
    T_{i,j}\left(
      \frac{4}{h^2 Pr} + \frac{1}{h} \psp{y}{+} + \frac{1}{h} \psp{x}{+} -
      \frac{1}{h} \psp{y}{-} - \frac{1}{h} \psp{x}{-}
    \right) = \\
      T_{i-1,j}\left(
        \frac{1}{Pr h^2} + \frac{1}{h} \psp{y}{+}
      \right) +
      T_{i,j-1}\left(
        \frac{1}{Pr h^2} + \frac{1}{h} \psp{x}{-}
      \right) + \\
      T_{i+1,j}\left(
        \frac{1}{Pr h^2} + \frac{1}{h} \psp{y}{-}
      \right) +
      T_{i,j+1}\left(
        \frac{1}{Pr h^2} + \frac{1}{h} \psp{x}{+}
      \right)
  \end{multline*}

  Закон сохранения массы:

  \begin{gather*}
    \dder{\psi}{x} + \dder{\psi}{y} + \omega = 0
    \\
    \frac{4}{h^2}\psi_{i,j} = \frac{1}{h^2} \left(
      \psi_{i,j+1} + \psi_{i,j-1} + \psi_{i-1,j} + \psi_{i+1,j}
    \right) + \omega_{i,j}
  \end{gather*}

  Закон сохранения движения:

  \begin{gather*}
    \der{\psi}{y} \der{\omega}{x} - \der{\psi}{x} \der{\psi}{y} =
      \dder{\omega}{x} + \dder{\omega}{y} + Gr \der{T}{x}
    \\
    \left(
      \psp{y}{+} \omega_{\overline{x}} + \psp{y}{-} \omega_{x}
    \right) -
    \left(
      \psp{x}{-} \omega_{\overline{y}} + \psp{x}{+} \omega_{y}
    \right) =
    \omega_{x \overline{x}} + \omega_{y \overline{y}} + Gr \der{T}{x}
  \end{gather*}
  \begin{multline*}
    \frac{1}{h} \left(
      \psp{y}{+} \omega_{i, j} - \psp{y}{+} \omega_{i-1, j} +
      \psp{y}{-} \omega_{i+1, j} - \psp{y}{-} \omega_{i, j}
    \right) -
    \\
    \frac{1}{h} \left(
      \psp{x}{-} \omega_{i, j} - \psp{x}{-} \omega_{i, j-1} +
      \psp{x}{+} \omega_{i, j+1} - \psp{x}{+} \omega{i, j}
    \right) =
    \\
    \frac{1}{h^2} \left(
      \omega_{i+1, j} + \omega_{i-1, j} + \omega_{i, j-1} + \omega_{i, j+1} -
      4 \omega{i, j}
    \right) + Gr T_{\mathring{x}}
  \end{multline*}
  \begin{multline*}
    \omega_{i, j} \left(
      \frac{4}{h} + \psp{y}{+} - \psp{y}{-} - \psp{x}{-} + \psp{x}{+}
    \right) =
    \\
    \omega_{i+1, j} \left( \frac{1}{h} - \psp{y}{-} \right) +
    \omega_{i-1, j} \left( \frac{1}{h} + \psp{y}{+} \right) +
    \omega_{i, j-1} \left( \frac{1}{h} - \psp{x}{-} \right) +
    \omega_{i, j+1} \left( \frac{1}{h} + \psp{x}{+} \right) +
    Gr T_{\mathring{x}}
  \end{multline*}

\begin{tikzpicture}
\begin{axis}
\addplot3[
contour gnuplot={
output point meta=rawz,
},
z filter/.code={\def\pgfmathresult{1}},
]
coordinates {
(0,0,0) (1,0,0) (2,0,0) (3,0,0)
(0,1,0) (1,1,0.6) (2,1,0.7) (3,1,0.5)
(0,2,0) (1,2,0.7) (2,2,0.8) (3,2,0.5)
};
\end{axis}%
\end{axis}
\end{tikzpicture}
\end{document}
